# 网科银行一部shell分享会

### 为什么是Shell

#### 我们需要工具解放生产力

在日常工作中，我们经常会有一些比较繁琐，重复，但是又对准确性有一定要求的工作。

这些任务中轻量级的任务有 给文件去除多余的空行;刷数据时大量插入sql的书写;交换中心配置文件的书写 ...

重量级的任务有 新增核心错误码入库时确认新增错误码是否在生产库中已经存在;上线包中如果文件列表过多(100+),如何根据已有打包工具生成的脚本得到新的脚本;项目成果交付银行时，在只有项目生产包的情况下如何快速抽取项目源码包 ...

所有这些工作，都是繁琐的，而且需要准确性的，需要耗费我们大量的时间，我们在做所有这些工作的时候，有没有想过有一个工具,只要3秒钟的时间，敲击一下命令，就把所有这些繁琐的工作全部解决，然后回家好好休息该干嘛干嘛

然而很多时候，针对这些特定化的需求，很难有特定的工具能满足我们，所以作为一枚从事创造性工作的coder（关于创造性，至少我本人这么觉得）,我们自己作出我们想要的工具吧！

#### 我们要有好的材料和胶水

作为一名java从业人员，至少在座的大家估计都是，很容易就想到用java去实现我们想要的东西，而我一开始确实是这样做的,然而在使用java做这些开发的时候，我编写了大量丑陋的工具类来帮我快速将逻辑过度到对需求的处理.

但是一个很简单的想法，用java就需要大量的代码，譬如去除一个文本文件中重复的行。用java的写法是获取文件的BufferReader输入流，再依次读取文件将文件放到一个set数据结构中，然后获取一个文件的PrintStream流再将set中的数据写入该新的文件中。这里面用到了文件读写，异常处理，for循环处理，数据结构set的选用.

这样是不是太麻烦呢，一个简单的想法需要那么多代码实现，在数据量没达到一定层度的时候或许不会比手动操作省时。

于是在同事的启发下我知道有一种更好的语言类型，或者说是工具集能帮助我大大节省工具开发的时间。这种语言类型就是脚本。而针对刚才的去重的需求，用脚本一句话就可以解决了 sort fileName |uniq > newFileName

然后我上网查询了相关资料，发现世界上有太多的人正在相同的情景下采取了类似的行动，有的甚至自创了一门脚本语言。经常查资料，我选定了Shell作为我学习的第一门脚本语言，第一款制作工具的材料和胶水，来解决我工作中所有重复而需要准确率的问题。

### Shell是什么,Awk，Sed又是什么呢

在很多人的眼中，Shell只是一个个单独的linux命令，是mkdir, cp, rm。能完成一些在我windows上拖拽拖拽就能完成的简单的工作。在另外一部人的眼中，他们认为Shell是只有运维才能明白的复杂的脚本集合,他们用shell来做一些我们不明白也不必做的事。

其实不是这样，Shell是一门比较完善的语言，就像我们最初接触的C语言一样，有基本的变量，方法的组织结构，也有if,case,循环等常规的语言结构。这些东西，和其他语言一样，都是内置在Shell解释器本身的基本语言元素，这些元素,我们基本上不用学习就可以使用。

与C这种高级语言不同的是，Shell里面可以直接调用Linux环境下的各种工具:sort, head, tail,uniq...，这些工具就像高级语言里面的API一样，但是无疑又强大太多，简单一行代码就能完成一般高级语言上十句百句才能完成的任务。这些Linux原生工具集能大大简化我们的编程任务。

Awk就是这些工具集中的一个比较特别的家伙，它本省就是一门语言，也被称为可编程的列编辑器。要知道在Linux下，所有的工具集处理的基本元素都是记录，记录一般就是一串以换行符结尾的数据，Awk的输入也是一条条记录，但处理的却是以制定字符分开的一列列数据。

类似的，Sed被称为可编程的行编辑器。可以对但条记录基于正则表达式作大部分编辑过程中需要的自动化处理。

### 我拿Shell干什么

至从去年10月份单独做项目开始，我的工作内容中就不断冒出各种需要重复劳动但又需要保证精确的任务。最开始上线脚本的书写，而旧的打包工具只支持就版本的上线脚本格式。我是个做事不够精细的人，在写上线脚本这种要求准确精细的活上，我是很难保证自己不犯错的。于是第一个需求产生了，基于旧有的上线脚本制作一个脚本转换工具。编码之前，花了一个星期的下班后的时间来看书，学习Shell编程相关的知识。然后在需要上测试的前夜写成了脚本转换工具的第一版。见shellManage/shlib.

类似的需求接踵而至，于是在11月到1月份的这段时间内我开始写一个又一个Shell工具来辅助我的工作。

### 案例

脚本转换工具

抽源码包工具

### 怎么学习Shell

**code**

code是学习编码的最佳方式，在有清晰的需求的情况下，边查询资料，边code是学习编码的最佳方式。

**学习材料**

我也整理了一版学习shell的基础脚本。

同时也有两本推荐书

Linux Shell编程从入门到精通/张昊

sed & awk/多尔蒂，罗宾斯/张旭东等译

网站 http://man.linuxde.net/ 

### 分享的目的

给大家一个关于Shell的浅显的认识，了解日常工作中Shell相应的应用环境，激发大家学习并运用Shell的兴趣。

### 交流

大家的所思所想 我的所思所想

### 其他

**shell分享材料地址**	https://github.com/luoziyihao/shell_share.git

**我的shell工具集** https://github.com/luoziyihao/shellManage

**shell学习材料** http://pan.baidu.com/s/1mhr1O6k
